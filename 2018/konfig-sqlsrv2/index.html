<!doctype html><html lang=en><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="chrome=1"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content=noodp><link rel=prev href=https://mfachrulrazy.github.io/2018/ssh-key-putty/><link rel=next href=https://mfachrulrazy.github.io/2018/aktivasi-winsrv/><link rel=canonical href=https://mfachrulrazy.github.io/2018/konfig-sqlsrv2/><link rel="shortcut icon" type=image/x-icon href=/favicon.ico><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest href=/site.webmanifest><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content=#da532c><meta name=theme-color content=#ffffff><title>Belajar SQL Server Part 2 | MFR Official Blog</title><meta name=title content="Belajar SQL Server Part 2 | MFR Official Blog"><link rel=stylesheet href=/font/iconfont.css><link rel=stylesheet href=/css/main.min.css><meta name=twitter:card content=summary><meta name=twitter:title content="Belajar SQL Server Part 2"><meta name=twitter:description content="Postingan kali ini akan membahas mengenai teori teknologi replikasi dalam SQL Server, karena kebetulan di kantor sedang menerapkan teknologi tersebut.
Menghapus Database SQL Menghapus database dengan menggunakan query sql jika tidak dapat dihapus dari Management Studio yang biasanya penyebabnya adalah masih ada koneksi yang tidak dapat diputus koneksinya. IF EXISTS (SELECT name FROM master.dbo.sysdatabases WHERE name = N'NamaDatabase') DROP DATABASE NamaDatabase DECLARE @kill varchar(8000) = '' SELECT @kill = @kill &#43; 'kill ' &#43; CONVERT(varchar(5), spid) &#43; ';' FROM master."><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"Belajar SQL Server Part 2","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/mfachrulrazy.github.io\/2018\/konfig-sqlsrv2\/"},"image":{"@type":"ImageObject","url":"https:\/\/mfachrulrazy.github.io\/cover.png","width":800,"height":600},"genre":"posts","keywords":"database, sql server","wordcount":282,"url":"https:\/\/mfachrulrazy.github.io\/2018\/konfig-sqlsrv2\/","datePublished":"2018-07-21T00:00:00\x2b00:00","dateModified":"2018-07-21T00:00:00\x2b00:00","publisher":{"@type":"Organization","name":"MFR","logo":{"@type":"ImageObject","url":"https:\/\/mfachrulrazy.github.io\/logo.png","width":127,"height":40}},"author":{"@type":"Person","name":"MFR"},"description":""}</script></head><body><div class=wrapper><nav class=navbar><div class=container><div class="navbar-header header-logo"><a href=https://mfachrulrazy.github.io/>MFR Official Blog</a></div><div class="menu navbar-right"><a class=menu-item href=/categories/>Categories</a>
<a class=menu-item href=/tags/>Tags</a>
<a class=menu-item href=/about>About</a>
<a class=menu-item href=/ref>References</a>
<a href=javascript:void(0); class=theme-switch><i class="iconfont icon-dribbble"></i></a>&nbsp;</div></div></nav><nav class=navbar-mobile id=nav-mobile style=display:none><div class=container><div class=navbar-header><div><a href=javascript:void(0); class=theme-switch><i class="iconfont icon-dribbble"></i></a>&nbsp;<a href=https://mfachrulrazy.github.io/>MFR Official Blog</a></div><div class=menu-toggle><span></span><span></span><span></span></div></div><div class=menu id=mobile-menu><a class=menu-item href=/categories/>Categories</a>
<a class=menu-item href=/tags/>Tags</a>
<a class=menu-item href=/about>About</a>
<a class=menu-item href=/ref>References</a></div></div></nav><main class=main><div class=container><article class=post-warp><header class=post-header><h1 class=post-title>Belajar SQL Server Part 2</h1><div class=post-meta>Written by <a href=https://mfachrulrazy.github.io/ rel=author>MFR</a> with ♥
<span class=post-time>on <time datetime=2018-07-21>21 July 2018</time></span>
in
<i class="iconfont icon-folder"></i><span class=post-category><a href=https://mfachrulrazy.github.io/categories/database/>database</a>
<a href=https://mfachrulrazy.github.io/categories/sql-server/>sql server</a></span>
<i class="iconfont icon-timer"></i>2 min</div></header><div class=post-content><p>Postingan kali ini akan membahas mengenai teori teknologi replikasi dalam SQL Server, karena kebetulan di kantor sedang menerapkan teknologi tersebut.</p><h3 id=menghapus-database-sql>Menghapus Database SQL</h3><p>Menghapus database dengan menggunakan query sql jika tidak dapat dihapus dari Management Studio yang biasanya penyebabnya adalah masih ada koneksi yang tidak dapat diputus koneksinya.<div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=color:#66d9ef>IF</span> <span style=color:#66d9ef>EXISTS</span> (<span style=color:#66d9ef>SELECT</span> name <span style=color:#66d9ef>FROM</span> master.dbo.sysdatabases <span style=color:#66d9ef>WHERE</span> name <span style=color:#f92672>=</span> N<span style=color:#e6db74>&#39;NamaDatabase&#39;</span>)
<span style=color:#66d9ef>DROP</span> <span style=color:#66d9ef>DATABASE</span> NamaDatabase

<span style=color:#66d9ef>DECLARE</span> <span style=color:#f92672>@</span>kill varchar(<span style=color:#ae81ff>8000</span>) <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;&#39;</span>
<span style=color:#66d9ef>SELECT</span> <span style=color:#f92672>@</span>kill <span style=color:#f92672>=</span> <span style=color:#f92672>@</span>kill <span style=color:#f92672>+</span> <span style=color:#e6db74>&#39;kill &#39;</span> <span style=color:#f92672>+</span> <span style=color:#66d9ef>CONVERT</span>(varchar(<span style=color:#ae81ff>5</span>), spid) <span style=color:#f92672>+</span> <span style=color:#e6db74>&#39;;&#39;</span>
<span style=color:#66d9ef>FROM</span> master..sysprocesses 
<span style=color:#66d9ef>WHERE</span> dbid <span style=color:#f92672>=</span> db_id(<span style=color:#960050;background-color:#1e0010>‘</span>NamaDatabase<span style=color:#960050;background-color:#1e0010>’</span>) <span style=color:#66d9ef>and</span> spid <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>50</span> <span style=color:#66d9ef>and</span> spid <span style=color:#f92672>&lt;&gt;</span> <span style=color:#f92672>@@</span>spid
<span style=color:#66d9ef>EXEC</span>(<span style=color:#f92672>@</span>kill);</code></pre></div></p><h3 id=menambahkan-user-select-pada-database>Menambahkan User &lsquo;select&rsquo; pada Database</h3><p>Menambahkan user pada salah satu database dengan <em>role</em> hanya dapat memilih.<br>1. Buka aplikasi Management Studio. Pilih <code>Security</code> &gt; <code>Logins</code> &gt; <code>New Login</code>. Masukkan Nama user dan password serta pilih <em>default database</em><figure><img src=/images/ring.svg data-sizes=auto data-src=/img/sqlsrv/adduser1.png alt class=lazyload><figcaption class=image-caption></figcaption></figure>2. Kemudian buat database role baru pada database<figure><img src=/images/ring.svg data-sizes=auto data-src=/img/sqlsrv/adduser2.png alt class=lazyload><figcaption class=image-caption></figcaption></figure>3. Masukkan nama role dan OK<figure><img src=/images/ring.svg data-sizes=auto data-src=/img/sqlsrv/adduser3.png alt class=lazyload><figcaption class=image-caption></figcaption></figure>4. Klik kanan pada Database yang akan ditambahkan role baru &gt; <code>Properties</code><br>5. Cari role yang telah dibuat<figure><img src=/images/ring.svg data-sizes=auto data-src=/img/sqlsrv/adduser4.png alt class=lazyload><figcaption class=image-caption></figcaption></figure>6. Pilih grant &lsquo;Select&rsquo; &gt; <code>OK</code><figure><img src=/images/ring.svg data-sizes=auto data-src=/img/sqlsrv/adduser5.png alt class=lazyload><figcaption class=image-caption></figcaption></figure>7. Kemudian pada bagian <code>User</code> di Database &gt; klik Kanan &gt; <code>Properties</code><br>8. Pada bagian <code>Membership</code> &gt; pilih role database yang telah dibuat<figure><img src=/images/ring.svg data-sizes=auto data-src=/img/sqlsrv/adduser6.png alt class=lazyload><figcaption class=image-caption></figcaption></figure></p><h3 id=set-multi-user-database>Set Multi User Database</h3><p>Terkadang ketika restore database, kita harus menutup seluruh koneksi yang ada pada database tersebut. Jika dlakukan secara paksa, maka akan membuat database menjadi <code>single user</code> untuk merubahnya bisa dilakukan dengan query berikut.<br><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=color:#66d9ef>ALTER</span> <span style=color:#66d9ef>DATABASE</span> NamaDB
<span style=color:#66d9ef>SET</span> MULTI_USER;
<span style=color:#66d9ef>GO</span></code></pre></div></p><h3 id=status-restore-database-tidak-berubah>Status Restore Database tidak berubah</h3><p>Ketika me-restore database terkadang terjadi error seperti status restore database tidak berubah seperti gambar di bawah ini.<br><figure><img src=/images/ring.svg data-sizes=auto data-src=/img/sqlsrv/restore-db1.png alt class=lazyload><figcaption class=image-caption></figcaption></figure><br>Untuk mengatasi hal tersebut bisa dengan menggunakan query di t-sql dengan me-restore dan menggunakan opsi with recovery.<br><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql>RESTORE <span style=color:#66d9ef>DATABASE</span> NamaDB <span style=color:#66d9ef>FROM</span> DISK <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;Path\to\file.bak&#39;</span>
<span style=color:#66d9ef>WITH</span> RECOVERY
<span style=color:#66d9ef>GO</span></code></pre></div></p></div><div class=post-copyright><p class=copyright-item><span>Author:</span>
<span>MFR</span></p><p class=copyright-item><span>Share:</span>
<span><a href="//twitter.com/share?url=https%3a%2f%2fmfachrulrazy.github.io%2f2018%2fkonfig-sqlsrv2%2f&amp;text=Belajar%20SQL%20Server%20Part%202&amp;via=muhfachrulrazy" target=_blank title="Share on Twitter"><i class="iconfont icon-twitter"></i></a><a href="//www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fmfachrulrazy.github.io%2f2018%2fkonfig-sqlsrv2%2f" target=_blank title="Share on Facebook"><i class="iconfont icon-facebook"></i></a><a href="//www.linkedin.com/shareArticle?url=https%3a%2f%2fmfachrulrazy.github.io%2f2018%2fkonfig-sqlsrv2%2f&amp;title=Belajar%20SQL%20Server%20Part%202" target=_blank title="Share on LinkedIn"><i class="iconfont icon-linkedin"></i></a></span></p></div><div class=post-tags><section><i class="iconfont icon-icon-tag"></i>Tag:
<span class=tag><a href=https://mfachrulrazy.github.io/tags/database/>#database</a></span>
<span class=tag><a href=https://mfachrulrazy.github.io/tags/sql-server/>#sql server</a></span></section><section><a href=javascript:window.history.back();>Back</a></span> ·
<span><a href=https://mfachrulrazy.github.io/>Home</a></span></section></div><div class=post-nav><a href=https://mfachrulrazy.github.io/2018/ssh-key-putty/ class=prev rel=prev title="Membuat SSH Key Pair di Putty"><i class="iconfont icon-dajiantou"></i>&nbsp;Membuat SSH Key Pair di Putty</a>
<a href=https://mfachrulrazy.github.io/2018/aktivasi-winsrv/ class=next rel=next title="Aktivasi Windows Server 2012">Aktivasi Windows Server 2012&nbsp;<i class="iconfont icon-xiaojiantou"></i></a></div><div class=post-comment></div></article></div></main><footer class=footer><div class=copyright>&copy;
<span itemprop=copyrightYear>2015 - 2019</span>
<span class=author itemprop=copyrightHolder><a href=https://mfachrulrazy.github.io/>MFR</a> |</span>
<span>Crafted with ❤️ by Us</span></div></footer><link href=//lib.baomitu.com/lightgallery/1.6.12/css/lightgallery.min.css rel=stylesheet><script src=/js/vendor_gallery.min.js async></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-148178248-1','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script></div></body></html>